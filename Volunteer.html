<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Aspen View Academy Volunteer Database</title>
	<link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.8.20/themes/base/jquery.ui.all.css" />
	<link rel="stylesheet" href="styles/volunteer.css" />
	<link rel="stylesheet" href="styles/jquery-impromptu.css" />
	<link rel="stylesheet" href="fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-45048800-1', 'aspenviewacademy.org');
		ga('send', 'pageview');
	</script>
</head>
<body>
<noscript>
	This site requires javascript to run properly.  Please enable javascript in your browser and reload the page.
</noscript>
<div class="demo outerContainer ui-widget">
	<div class="logo">	
		<a href="http://www.aspenviewacademy.com">
			<img id="avaLogo" src="http://aspenviewacademy.org/site/templates/vision/images/logo/AspenView%20Logo_Dots_mdm.jpg" />
		</a>
	</div>
	<div class="title">Aspen View Academy<br />Volunteer Database</div>
	<div id="login" ui-widget>
		<div class="loginBoxContainer">
			<div class="ui-widget validationErrorBox" style="display:none;">
				<div class="ui-state-error ui-corner-all" style="padding: 0 .7em;"> 
					<p><span class="ui-icon ui-icon-alert" style="float: left; margin-right: .3em;"></span> 
					<strong>There was a problem with your login:</strong><span class="validationErrorMsg"></span></p>
				</div>
			</div>

			<div class="loginBox">
				<h1>Volunteer Login</h1>
				<div>Email Address</div>
				<div><input type="textbox" id="loginEmailAddress" /></div>
				<div>Password</div>
				<div><input type="password" id="loginPassword" /></div>
				<div class="loginButton"><button id="loginButton">Login</button></div>
				<div class="createProfile">Don't have a login?  <a id="createProfileLink" href="javascript: void(0);">Create your volunteer profile.</a></div> 
			</div>
		</div>
	</div>

	<div id="tabs">
		<ul>
			<li><a href="#profileTab">My Volunteer Profile</a></li>
			<li><a href="#interestsTab">My Interests</a></li>
			<li id="hoursTabLI"><a href="#hoursTab">My Volunteer Hours</a></li>
			<li id="adminTabLI" class="hiddenTab"><a href="#adminTab">Admin</a></li>
			<span class="logout" style="float: right; margin-top: 5px;"><a id="logoutLink" href="javascript: void(0);">Logout</a></span>
		</ul>
		<div id="profileTab">
			<div class="profile">
				<div class="ui-widget validationErrorBox" style="display:none;">
					<div class="ui-state-error ui-corner-all" style="padding: 0 .7em;"> 
						<p><span class="ui-icon ui-icon-alert" style="float: left; margin-right: .3em;"></span> 
						<strong>Please correct the following errors before saving:</strong><span class="validationErrorMsg"></span></p>
					</div>
				</div>
				<div>
					<div class="profileColumn">
						<div class="innerProfileColumn">
							<div class="profileRow">
								<div class="profileHeader required"><label for="firstName">*First Name</label></div>
								<div class="profileValue"><input type="text" id="firstName" tabIndex="1" /></div>
							</div> 
							<div class="profileRow">
								<div class="profileHeader required"><label for="email">*Email Address</label></div>
								<div class="profileValue"><input type="text" id="email" tabIndex="3"/></div>
							</div>
							<div class="profileRow">
								<div class="profileHeader required"><label for="password">*Password</label></div>
								<div class="profileValue"><input type="password" id="password" tabIndex="5" /></div>
							</div>
							<div class="profileRow">
								<div class="profileHeader"><label for="familyId">*Family Number</label></div>
								<div class="profileValue"><input type="text" id="familyId" tabIndex="7" /></div>
							</div> 											
						</div>
					</div>
					<div class="profileColumn">
						<div class="innerProfileColumn">
							<div class="profileRow">
								<div class="profileHeader required"><label for="lastName">*Last Name</label></div>
								<div class="profileValue"><input type="text" id="lastName" tabIndex="2" /></div>
							</div> 
							<div class="profileRow">
								<div class="profileHeader required"><label for="confirmEmail">*Confirm Email Address</label></div>
								<div class="profileValue"><input type="text" id="confirmEmail" tabIndex="4" /></div>
							</div> 
							<div class="profileRow">
								<div class="profileHeader required"><label for="confirmPassword">*Confirm Password</label></div>
								<div class="profileValue"><input type="password" id="confirmPassword" tabIndex="6" /></div>
							</div> 
							<div class="profileRow">
								<div class="profileHeader required"><label for="primaryPhoneNbr">Phone Number</label></div>
								<div class="profileValue"><input type="text" id="primaryPhoneNbr" tabIndex="8" /></div>
							</div> 
							<div class="profileRow">
								<div class="profileHeader"></div>
								<div class="profileValue"><button id="profileSaveButton">Save</button></div>
							</div> 
						</div>
					</div>
				</div>
			</div>
		</div>
		<div id="interestsTab">
			<div class="interests">
				<div class="ui-widget validationErrorBox" style="display:none;">
					<div class="ui-state-error ui-corner-all" style="padding: 0 .7em;"> 
						<p><span class="ui-icon ui-icon-alert" style="float: left; margin-right: .3em;"></span> 
						<strong>Please correct the following errors before saving:</strong><span class="validationErrorMsg"></span></p>
					</div>
				</div>	
				<div>
					<div class="interestsColumn">
						<p class="interestsDescription">Areas of Interest - check all that apply</p>
						<ul class="interests" id="interestsList1"></ul>
						<ul class="interests" id="interestsList2"></ul>
						<ul class="interests" id="interestsList3"></ul>
						<div style="clear: both;"></div>
					</div>
					<button id="interestsSaveButton">Save</button>
				</div>
			</div>
		</div>
		<div id="hoursTab">
			<div class="hours">
				<div class="ui-widget validationErrorBox" style="display:none;">
					<div class="ui-state-error ui-corner-all" style="padding: 0 .7em;"> 
						<p><span class="ui-icon ui-icon-alert" style="float: left; margin-right: .3em;"></span> 
						<strong>Please correct the following errors before saving:</strong><span class="validationErrorMsg"></span></p>
					</div>
				</div>
				<div>
					<div class="hoursColumn">
						<div class="innerHoursColumn">
							<div class="hoursRow">
								<div class="hoursHeader required"><label for="hoursDate">*Date</label></div>
								<div class="hoursValue"><input type="text" id="hoursDate"/></div>
							</div>
							<div class="hoursRow">
								<div class="hoursHeader required"><label for="hours">*Hours</label></div>
								<div class="hoursValue"><input type="text" id="hours"/></div>
							</div>
							<div class="hoursRow">
								<div class="hoursHeader required"><label for="hoursArea">*Area of Work</label></div>
								<div class="hoursValue">
									<select id="hoursArea">
										<option value="">Select...</option>
									</select>
								</div>
							</div>
							<div class="hoursRow">
								<div class="hoursHeader required"><label for="hoursDescription">Description</label></div>
								<div class="hoursValue" style="vertical-align:top;"><textarea id="hoursDescription" rows="5" cols="40"></textarea></div>
							</div>
							<div class="hoursRow">
								<div class="hoursHeader"></div>
								<div class="hoursValue"><button id="submitHoursButton">Submit Hours</button></div>
							</div> 
						</div>
					</div>
					<div class="hoursColumn">
						<div class="innerHoursColumn">
							<div class="hoursRow">
								<div class="hoursHeader">Pending Hours:</div>
								<div id="pendingTotalHours" class="hoursValue totalHours">Not Available</div>
							</div>
							<div class="hoursRow">
								<div class="hoursHeader">Approved Hours:</div>
								<div id="personalTotalHours" class="hoursValue totalHours">Not Available</div>
							</div>
							<div class="hoursRow">
								<div class="hoursHeader">Total Family Hours:</div>
								<div id="familyTotalHours" class="hoursValue totalHours">Not Available</div>
							</div>
							<div class="hoursRow">
								<div class="hoursHeader">&nbsp;</div>
							</div> 
						</div>
						<a class="fancybox" href="#hoursList">View Detailed Volunteer Time</a>
					</div>
				</div>
				<div id="hoursList" style="display:none;">
					<table></table>
				</div>
			</div>		
		</div>
	    <div id="adminTab">
	        <div id="admin">
		        <ul>
			        <li><a href="#adminVolunteersTab">Volunteers</a></li>
			        <li><a href="#adminHoursTab">Hours</a></li>
			        <li><a href="#adminReportsTab">Reports</a></li>
		        </ul>
		        <div id="adminVolunteersTab">
	                <table id="adminVolunteerList">
	                    <tr>
	                        <th>Last Name</th>
	                        <th>First Name</th>
	                        <th>Email Address</th>
	                        <th>Status</th>
	                        <th>Approved Hours</th>
	                    </tr>
	                </table>
	            </div>
		        <div id="adminHoursTab">
	                <p class="reportTitle">Hours by Status</p>
	                <p>Select a Status:
		                <select id="adminHoursStatus">
							<option selected>Pending</option>
							<option>Approved</option>
							<option>Declined</option>
						</select>
					</p>
					<p id="adminHoursTotal"></p>
	               <table id="adminHoursList"></table>
	            </div>
		        <div id="adminReportsTab">
	                <p class="reportTitle">Volunteers by Interest Area</p>
	                <p>Select an interest area:
		                <select id="reportInterestArea">
							<option value="">Select...</option>
						</select>
					</p>
	               <table id="adminReportList"></table>
	            </div>
	            <div>

	            </div>
	        </div>
	    </div>
	</div>
</div>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.8.20/jquery-ui.min.js"></script>
<script type="text/javascript" src="fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<script src="scripts/Impromptu.js"></script>
<script src="scripts/volunteer.js"></script>
<script>
	$(function () {
		$("#loginButton").button();
		$("#userName").focus();
		$(".loginBox").keypress(function (e) {  
			if ((e.which && e.which == 13) || (e.keyCode && e.keyCode == 13)) {
				$('#loginButton').click();
				return true;
			}
		});

		$("#createProfileLink").bind("click", function() {
			UserMgrFactory.getUserMgr().init();
		});

		$("#loginButton").click(function () {
			loginErrorSvc.hideErrors();
			var credentials = loginSvc.getCredentialsFromForm();
			var errors = loginSvc.validate(credentials);
			if(errors.length > 0) {
				loginErrorSvc.showErrors(errors);
			}
			else {
				$('#loginButton').button("disable");
				loginSvc.getAccessToken(credentials, function(error, accessToken) {
					$('#loginButton').button("enable");

					if(error) {
						loginErrorSvc.showErrors([validationErrorCodes.LOGIN_CREDENTIALS_INCORRECT]);
					}
					else {
						sessionMgr.setAccessToken(accessToken);

						UserMgrFactory.getUserMgr().init();
					}
				});
			}
		});

		$("#tabs").hide();

		$("#tabs").tabs();

		$("#admin").tabs();

		$("#profileSaveButton").button();
		$("#profileSaveButton").click(function () {
			UserMgrFactory.getUserMgr().saveProfile();
		});

		$("#interestsSaveButton").button();
		$("#interestsSaveButton").click(function () {
			UserMgrFactory.getUserMgr().saveInterests();
		});

		$("#hoursDate").datepicker();

		$("#submitHoursButton").button();
		$("#submitHoursButton").click(function () {
			UserMgrFactory.getUserMgr().saveHours();
		});

		$("#reportInterestArea").change(function (a) {
			var interestAreaId = a.srcElement.value;
			UserMgrFactory.getUserMgr().runInterestAreaReport(interestAreaId);
		});

		$("#adminHoursStatus").change(function (a) {
			var status = a.srcElement.value;
			UserMgrFactory.getUserMgr().displayAdminHoursByStatus(status);
		});

		$("#loginEmailAddress").focus();

		$("#logoutLink").click(function () {
			loginSvc.logout();
		});

		$(".fancybox").fancybox();

		if(sessionMgr.isAuthenticated()) {
			UserMgrFactory.getUserMgr().init();
		}
    });

	var sessionMgr = new SessionMgr();
	var loginSvc = new LoginSvc($("div#login"));
	var loginErrorSvc = new ErrorSvc($("div#login"));
	var volunteerSvc = new VolunteerSvc($("div.profile"));
	var profileErrorSvc = new ErrorSvc($("div.profile"));
	var interestsSvc = new InterestsSvc($("div.interests"));
	var volunteerHoursSvc = new VolunteerHoursSvc($("div.hours"));
	var volunteerHoursErrorSvc = new ErrorSvc($("div.hours"));
	var adminVolunteerSvc = new AdminVolunteerSvc($("div#adminVolunteersTab"));
	var adminHoursSvc = new AdminHoursSvc($("div#adminHoursTab"));
	var adminReportsSvc = new AdminReportsSvc($("div#adminReportsTab"));
	var rightSvc = new RightSvc();
	var notificationMgr = new NotificationMgr();
</script>

</body>
</html>
